# DB-SYNC-SERVICE 專案說明

本專案為 **獨立的資料庫同步服務**，專門負責將正式環境資料同步到測試站和本地開發環境。

## 📋 專案資訊

**專案名稱**: db-sync-service
**用途**: 資料庫單向同步服務
**部署平台**: Zeabur（獨立專案）
**語言**: Python 3.9+

## 🎯 核心功能

- **單向同步**: 正式環境 (Zeabur) → 測試站 + 本地環境
- **自動執行**: 定期背景運行，無需人工介入
- **多目標支援**: 可同時同步到多個目標環境
- **增量同步**: 只同步變更的資料，節省資源
- **環境變數配置**: 所有連線和參數通過環境變數控制

## 📁 專案結構

```
db-sync-service/
├── main.py                 # 服務入口點
├── sync_worker.py          # 核心同步邏輯
├── config.py               # 環境變數配置管理
├── requirements.txt        # Python 依賴套件
├── Dockerfile              # Zeabur 部署配置
├── .env.example            # 環境變數範本
├── .gitignore              # Git 忽略配置
├── CLAUDE.md               # 本檔案（專案說明）
├── README.md               # 使用者說明文件
└── docs/                   # 文件資料夾
    ├── 01_ARCHITECTURE.md  # 架構設計文件
    ├── 02_IMPLEMENTATION.md # 實作步驟
    ├── 03_DEPLOYMENT.md    # 部署流程
    └── 04_TESTING.md       # 測試計劃
```

## 📚 文件說明

### 核心文件（docs/ 資料夾）

1. **`01_ARCHITECTURE.md`** - 架構設計文件
   - 系統架構圖
   - 資料流向說明
   - 環境變數設計
   - 安全機制

2. **`02_IMPLEMENTATION.md`** - 實作步驟
   - 詳細開發步驟
   - 每個檔案的功能說明
   - 代碼結構規劃
   - 依賴套件清單

3. **`03_DEPLOYMENT.md`** - 部署流程
   - Zeabur 部署步驟
   - 環境變數設定
   - 健康檢查配置
   - 監控和日誌

4. **`04_TESTING.md`** - 測試計劃
   - 單元測試項目
   - 整合測試流程
   - 部署前檢查清單
   - 驗證步驟

## 🔄 開發流程

### 當前進度

✅ 已完成：
- [x] 建立專案結構
- [x] 建立 CLAUDE.md
- [x] 建立 docs/ 文件
- [x] 實作核心代碼
  - [x] config.py - 環境變數配置管理
  - [x] sync_worker.py - 資料同步邏輯
  - [x] main.py - 服務入口點
- [x] 建立部署檔案
  - [x] requirements.txt - Python 依賴
  - [x] Dockerfile - 容器化配置
  - [x] .gitignore - Git 忽略設定
  - [x] .env.example - 環境變數範本

⏳ 待進行：
- [ ] 本地測試與驗證
- [ ] 建立本地 .env 配置
- [ ] Zeabur 部署
- [ ] 清理舊有整合

### 下一步

1. **本地測試** - 建立 .env 檔案並測試同步功能
2. **驗證功能** - 確認所有表格同步正常
3. **部署上線** - 部署到 Zeabur 獨立專案

## 🚨 重要提醒

- ⚠️ **在確認所有文件之前，不會開始寫 code**
- ⚠️ **所有設計和步驟都會先寫在 docs/ 中**
- ⚠️ **部署前會進行完整測試**

## 📝 Git 版本控制規範

### Commit 訊息規則

**⚠️ 絕對禁止事項**：
- ❌ **不要在 commit 訊息中提到 AI 助手名稱**（如 Claude、ChatGPT 等）
- ❌ **不要使用自動生成的標記**（如 "Generated with..."、"Co-Authored-By: Claude" 等）
- ❌ **不要在 commit 訊息中暴露使用 AI 的事實**

**正確做法**：
- ✅ 使用清楚、專業的技術描述
- ✅ 專注於「做了什麼」而非「誰做的」
- ✅ 描述功能、修改、優化的具體內容

### Commit 訊息格式

```
簡短標題（50字以內）

1. 功能/修改類別
   - 具體變更描述
   - 相關檔案說明

2. 另一個功能/修改
   - 描述

修改檔案：
- 檔案名稱: 變更說明
```

### 良好的 Commit 訊息範例

```
新增資料庫同步服務架構設計

1. 建立專案結構
   - 建立 db-sync-service/ 資料夾
   - 建立 docs/ 文件資料夾

2. 完成架構文件
   - 系統架構設計
   - 環境變數配置
   - 安全機制設計

修改檔案：
- docs/01_ARCHITECTURE.md: 架構設計文件
- docs/02_IMPLEMENTATION.md: 實作步驟
- CLAUDE.md: 專案說明
```

### 提交時機

**建議的提交時機**：
- 完成一個完整的功能模組
- 完成一組相關文件
- 修復一個 bug
- 完成一個重要的配置變更

**提交前檢查清單**：
- [ ] 確認所有修改的檔案都符合預期
- [ ] 檢查是否有遺漏的檔案需要加入
- [ ] 撰寫清楚的 commit 訊息（不提及 AI）
- [ ] 確認 commit 訊息專業且技術性

## 🔗 相關連結

- 主專案：`../backend/` 和 `../frontend/`
- 主專案文件：`../docs/`
- 原同步邏輯：`../backend/scripts/sync_db_incremental.py`
- 主專案 Git 規範：`../docs/GIT_WORKFLOW.md`

---

**建立日期**: 2025-10-03
**最後更新**: 2025-10-03 (核心代碼實作完成)
